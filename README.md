# Multi-level_MSM

The code for the simulation and real data analysis for the paper `Marginal Structural Models for Multi-level Clustered Data' by Wu et al. (2022) was provided.

sim_Table1_one_stage.R can perform the one-stage method while using a fixed effects model to estimate the treatment probability;

sim_Table1_two_stage.R can perform the two-stage method while using a fixed effects model to estimate the treatment probability;

sim_Table2_one_stage.R can perform the one-stage method while using a mixed effects model to estimate the treatment probability;

sim_Table2_two_stage.R can perform the two-stage method while using a mixed effects model to estimate the treatment probability;

real_data.R can performed the real data analysis in the paper. Since the AAA dataset is not publicly available, we created a simulated real data for illustration.
